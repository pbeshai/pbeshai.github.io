<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-blog-post-js.1d3c152f5f561507ccdb.css">code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:.92em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:16px 0 32px;overflow:auto;border-bottom:2px solid #f1f3f5;background:#fbfbfc;border-radius:4px}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:none}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.0.59"/><title data-react-helmet="true">Scatterplots in D3 with Voronoi Interaction - Peter Beshai</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:700|Karla:400,400i,700" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="In this post, I explain how to add hover behavior to a scatterplot using D3&#x27;s Voronoi diagram capabilities without actually drawing the Voronoi polygons."/><meta data-react-helmet="true" name="twitter:description" content="In this post, I explain how to add hover behavior to a scatterplot using D3&#x27;s Voronoi diagram capabilities without actually drawing the Voronoi polygons."/><meta data-react-helmet="true" property="og:description" content="In this post, I explain how to add hover behavior to a scatterplot using D3&#x27;s Voronoi diagram capabilities without actually drawing the Voronoi polygons."/><meta data-react-helmet="true" name="keywords" content="data vis, visualization, creative coding, generative art, nba, basketball"/><meta data-react-helmet="true" name="twitter:site" content="@pbesh"/><meta data-react-helmet="true" name="twitter:creator" content="@pbesh"/><meta data-react-helmet="true" property="og:title" content="Scatterplots in D3 with Voronoi Interaction"/><meta data-react-helmet="true" property="twitter:title" content="Scatterplots in D3 with Voronoi Interaction"/><meta data-react-helmet="true" property="og:url" content="https://peterbeshai.com/blog/2016-10-30-scatterplot-in-d3-with-voronoi-interaction/"/><meta data-react-helmet="true" property="og:image" content="https://peterbeshai.com/static/6eae8687ef3d9c1b1a72e0f9b2ffe40e/89b45/preview.png"/><meta data-react-helmet="true" name="twitter:image" content="https://peterbeshai.com/static/6eae8687ef3d9c1b1a72e0f9b2ffe40e/89b45/preview.png"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#000000"/><style data-styled="iDyhdk efFTfJ hhyHDk gTlRLk jsxnmT jeewNL hhXpxd jrfCIt ecGEQi dJCJrh ijWubC euoGcv cnqcGN jnpqTa bQkNVd dFzgml" data-styled-version="4.1.1">
/* sc-component-id: sc-bdVaJa */
.iDyhdk{margin-left:auto;margin-right:auto;padding:16px;max-width:800px;}.efFTfJ{margin-bottom:16px;}.hhyHDk{margin-top:128px;}.gTlRLk{margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px;padding-top:64px;padding-bottom:64px;}
/* sc-component-id: sc-htpNat */
.jsxnmT{text-align:center;}.jeewNL{margin-bottom:32px;margin-top:16px;}
/* sc-component-id: sc-bxivhb */
.hhXpxd{margin:0px;font-size:23px;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-transform:uppercase;-webkit-letter-spacing:0.035em;-moz-letter-spacing:0.035em;-ms-letter-spacing:0.035em;letter-spacing:0.035em;}.jrfCIt{margin:0px;font-size:27px;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-transform:uppercase;-webkit-letter-spacing:0.035em;-moz-letter-spacing:0.035em;-ms-letter-spacing:0.035em;letter-spacing:0.035em;}.ecGEQi{margin:0px;margin-bottom:16px;margin-top:64px;font-size:23px;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-transform:none;-webkit-letter-spacing:0.035em;-moz-letter-spacing:0.035em;-ms-letter-spacing:0.035em;letter-spacing:0.035em;}.dJCJrh{margin:0px;margin-bottom:16px;margin-top:64px;font-size:27px;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-family:'IBM Plex Sans',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-transform:none;-webkit-letter-spacing:0.035em;-moz-letter-spacing:0.035em;-ms-letter-spacing:0.035em;letter-spacing:0.035em;}
/* sc-component-id: sc-ifAKCX */
.jnpqTa{color:#495057;border-bottom:2px solid #e9ecef;-webkit-text-decoration:none;text-decoration:none;background:transparent;-webkit-transition:0.2s background linear,0.2s border-color linear;transition:0.2s background linear,0.2s border-color linear;} .jnpqTa:hover{color:#343a40;background:#e3fafc;border-color:#99e9f2;}
/* sc-component-id: sc-bZQynM */
.bQkNVd{margin:0px;margin-left:auto;margin-right:auto;display:block;max-width:100%;height:auto;}
/* sc-component-id: core__List-eqpeba-0 */
.dFzgml{margin-bottom:32px;margin-top:0px;}
/* sc-component-id: core__InlineList-eqpeba-1 */
.ijWubC{list-style-type:none;padding-left:0;}.euoGcv{color:#868e96;list-style-type:none;list-style-type:none;padding-left:0;}
/* sc-component-id: core__InlineListItem-eqpeba-2 */
.cnqcGN{margin-right:16px;display:inline-block;} .cnqcGN:last-child{margin-right:0;} .cnqcGN::before{content:'â€¢';color:#dee2e6;margin-right:16px;} .cnqcGN:first-child::before{content:'';margin-right:0;}
/* sc-component-id: sc-global-1926057577 */
html,body,#___gatsby{background-color:#fff;width:100%;height:100%;padding:0;margin:0;color:#000;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-family:Karla,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;line-height:1.7;font-size:19px;} *{box-sizing:border-box;} #___gatsby > div{height:100%;} img.full-width-image{width:100%;} a{color:#495057;}</style><link as="script" rel="preload" href="/component---src-templates-blog-post-js-e86b92af2fef775e9216.js"/><link as="script" rel="preload" href="/app-b6ef64a05ca2a06bac27.js"/><link as="script" rel="preload" href="/1-be46941191aa236417e9.js"/><link as="script" rel="preload" href="/0-d7ef72559a49db3dc3fb.js"/><link as="script" rel="preload" href="/webpack-runtime-594d0c96fca390bc02fb.js"/><link rel="preload" href="/static/d/386/path---blog-2016-10-30-scatterplot-in-d-3-with-voronoi-interaction-5-d-6-449-FxQil3GmuCCdFSPzFvIhw3B2Hk0.json" as="fetch" crossOrigin="use-credentials"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div><div class="sc-bdVaJa iDyhdk"><div class="sc-htpNat jsxnmT"><h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb hhXpxd">Peter Beshai</h2><ul class="core__InlineList-eqpeba-1 ijWubC"><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a class="sc-ifAKCX jnpqTa" href="/">Home</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a class="sc-ifAKCX jnpqTa" href="/#writing">Writing</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a class="sc-ifAKCX jnpqTa" href="/#projects">Projects</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a class="sc-ifAKCX jnpqTa" href="/#experiments">Experiments</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a class="sc-ifAKCX jnpqTa" href="/#open-source">Open Source</a></li></ul></div></div><div class="sc-bdVaJa iDyhdk"><h2 font-size="4" font-weight="bold" font-family="header" class="sc-bxivhb jrfCIt">Scatterplots in D3 with Voronoi Interaction</h2><ul color="gray.6" class="core__InlineList-eqpeba-1 euoGcv"><li class="core__InlineListItem-eqpeba-2 cnqcGN">October 30, 2016</li><li class="core__InlineListItem-eqpeba-2 cnqcGN">7 min read</li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="./demo/" class="sc-ifAKCX jnpqTa">Demo</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="https://github.com/pbeshai/pbeshai.github.io/tree/master/src/blog/2016-10-30-scatterplot-in-d3-with-voronoi-interaction/demo" class="sc-ifAKCX jnpqTa">GitHub</a></li></ul><div><div class="sc-htpNat jeewNL">D3 v4.3.0 was <a href="https://github.com/d3/d3/releases/v4.3.0" class="sc-ifAKCX jnpqTa">just released</a>, and it came with a notable new feature: <a href="https://github.com/d3/d3-voronoi/blob/master/README.md#diagram_find" class="sc-ifAKCX jnpqTa"><em>diagram</em>.find</a> for <strong>d3-voronoi</strong>. With this great addition, we are now able to easily find which Voronoi region is under the mouse without rendering the Voronoi diagram polygons and relying on SVG mouse handlers. This means we can use Voronoi interactive behavior when other overlays in the vis consume mouse events, such as when using <a href="https://github.com/d3/d3-brush" class="sc-ifAKCX jnpqTa">d3-brush</a>, or even when using canvas instead of SVG-- but those are topics for another post.</div>
<div class="sc-htpNat jeewNL">In this post, I break down how we can make use of the new <code class="language-text">find()</code> function by using it to access the nearest point to the mouse in a scatterplot.</div>
<div class="sc-htpNat jeewNL"><img display="block" src="/scatterplot-voronoi-c73d58d6d6148ef69f87705ef63305f3.gif" alt="Demo GIF" class="sc-bZQynM bQkNVd"/></div>
<ul class="core__List-eqpeba-0 dFzgml">
<li class="sc-bdVaJa efFTfJ"><a href="./demo/" class="sc-ifAKCX jnpqTa">Live demo of the end result</a></li>
<li class="sc-bdVaJa efFTfJ"><a href="https://github.com/pbeshai/pbeshai.github.io/tree/master/src/blog/2016-10-30-scatterplot-in-d3-with-voronoi-interaction/demo" class="sc-ifAKCX jnpqTa">GitHub Code</a></li>
</ul>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Why Voronoi?</h2>
<div class="sc-htpNat jeewNL">We can think of a <a href="https://en.wikipedia.org/wiki/Voronoi_diagram" class="sc-ifAKCX jnpqTa">Voronoi diagram</a> as a method for expanding the hit area around points in a chart. Each point becomes a non-overlapping region such that if the mouse is inside that region, that point is the closest point to the mouse.</div>
<div class="sc-htpNat jeewNL">The main benefit of using a Voronoi diagram for highlighting the points in a scatterplot is that the regions defined by the diagram are typically much larger than the points, making it easier for users to explore the data. It&#x27;s also a more efficient method than computing the nearest point to the mouse position every time the mouse moves since we can precompute the Voronoi diagram once and re-use it as we need it.</div>
<div class="sc-htpNat jeewNL">Without further adieu, let&#x27;s get to making a simple scatterplot with interactivity powered by Voronoi diagrams!</div>
<h2 font-size="4" font-weight="bold" font-family="header" class="sc-bxivhb dJCJrh">Building a Basic Scatterplot</h2>
<div class="sc-htpNat jeewNL">Let&#x27;s start with describing how to build a simple scatterplot in D3. If you already know this, feel free to <a href="#voronoi" class="sc-ifAKCX jnpqTa">skip to the next section</a> on adding the Voronoi-powered interaction.</div>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Generating Random Data</h2>
<div class="sc-htpNat jeewNL">Before we even get started, let&#x27;s generate some random data that we can use for testing out the scatterplot. We can do this easily with <a href="https://github.com/d3/d3-array/blob/master/README.md#range" class="sc-ifAKCX jnpqTa">d3.range</a>.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// generate random data for 50 points</span>
<span class="token keyword">const</span> data <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  x<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  y<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  id<span class="token punctuation">:</span> i<span class="token punctuation">,</span>
  label<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`Point </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">With that, we have an array of 50 random data points we can use with our chart.</div>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Terminology</h2>
<div class="sc-htpNat jeewNL">I use slightly different terminology for the parts of a chart than is commonly seen on <a href="http://bl.ocks.org/" class="sc-ifAKCX jnpqTa">D3 blocks</a>. The standard seen in blocks is to have <code class="language-text">width</code> and <code class="language-text">height</code> describe the interior dimensions of the chart. I prefer to have <code class="language-text">width</code> and <code class="language-text">height</code> correspond to the actual outer width and height of the SVG container. I find this makes it easier to reason about when trying to layout multiple charts on a page, and is especially useful when the charts are packaged as reusable components.</div>
<div class="sc-htpNat jeewNL"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:678px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:70.50147492625369%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7ElEQVQ4y21Ti27jIBDM/3/Y6XTSPZI45FFdq+Zat1XqFxgbjO25XQyOE9XSeIEdZpdlWWVZhiRJ8Hm5YBwG0O8Gfo0+13X4dz57y99XXMZqCBuIia7RaJVCb1q4ltFg6CzKzwv+Hg84ih1OQkCVBQZrvd8xN/AHsqvBGlhj/ESRWCZr1MYu0EE1LXJVo9INSqUhW3PHmcDZrzizhja0SuJdNUhUB3EHXtsS9rXz2PFcWiSy82PGmuaqHydB1/c+w5e8wo4cewLbpKIxC4Y5r4voI6wrM62raU26YRKsaw1Qrd6qeiZPxM4LsI1jsfBtSXAbgl4Fhx6nhwdYXSMtpRfbEDFmthQ9BMQAMfiN4OPpiGdqh4/XF7zThXDUmMWf0sxiP3ONbxeFTWlugmzDsUUUvLyleHx6gswzn2F0ikUd2f7INL6T4K+8uTm+CDVM5iNjxGuaYqT2eZeaBMx8GfGYnBXX6hCOJu5KwXz2KxYc6TI658D9eM5K/C7aOeoc3W+goy1El5e2DaWZb9nycyL7QX3I/SWUC+i83fkLuvbcprIecc68dbUQ7EiQn1haVBBU/H2hcSwJxRWnssGhmHwir/2YOfswZlTWTYJj73xjaylhauXBL4fRyMrPdVUiPT9DFfnMibzIsVrjP4eTKGJ/C4OHAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
    <img display="block" class="gatsby-resp-image-image sc-bZQynM bQkNVd" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px #fff" alt="Chart Parts Diagram" title="" src="/static/fbb31790fd3cb198620689e9eb82d7fe/d6cff/chart_parts_diagram.png" srcSet="/static/fbb31790fd3cb198620689e9eb82d7fe/20869/chart_parts_diagram.png 175w, /static/fbb31790fd3cb198620689e9eb82d7fe/efae5/chart_parts_diagram.png 350w, /static/fbb31790fd3cb198620689e9eb82d7fe/d6cff/chart_parts_diagram.png 678w" sizes="(max-width: 678px) 100vw, 678px"/>
  </span></div>
<div class="sc-htpNat jeewNL">As shown in the diagram above, I use the following terms to describe the different parts of the chart:</div>





























<table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code class="language-text">width</code></td><td>The outer width of the chart</td></tr><tr><td><code class="language-text">height</code></td><td>The outer height of the chart</td></tr><tr><td><code class="language-text">plotAreaWidth</code></td><td>The inner width of the chart, where the circles are plotted</td></tr><tr><td><code class="language-text">plotAreaHeight</code></td><td>The inner height of the chart, where the circles are plotted</td></tr><tr><td><code class="language-text">padding</code></td><td>The space between the outer border and the inner area (the plot  area).</td></tr></tbody></table>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Setting up the Chart</h2>
<div class="sc-htpNat jeewNL">With that out of the way, let&#x27;s get started with the code for building the chart. We first define the dimensions and padding for our scatterplot.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// outer svg dimensions</span>
<span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token comment">// padding around the chart where axes will go</span>
<span class="token keyword">const</span> padding <span class="token operator">=</span> <span class="token punctuation">{</span>
  top<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  right<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
  bottom<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
  left<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// inner chart dimensions, where the dots are plotted</span>
<span class="token keyword">const</span> plotAreaWidth <span class="token operator">=</span> width <span class="token operator">-</span> padding<span class="token punctuation">.</span>left <span class="token operator">-</span> padding<span class="token punctuation">.</span>right<span class="token punctuation">;</span>
<span class="token keyword">const</span> plotAreaHeight <span class="token operator">=</span> height <span class="token operator">-</span> padding<span class="token punctuation">.</span>top <span class="token operator">-</span> padding<span class="token punctuation">.</span>bottom<span class="token punctuation">;</span>

<span class="token comment">// radius of points in the scatterplot</span>
<span class="token keyword">const</span> pointRadius <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">With these base values defined, we can next define the scales we&#x27;ll use for our x and y axes and for coloring the points. Since we used <code class="language-text">Math.random()</code> to generate the x and y values, we know the domains are <code class="language-text">[0, 1]</code>, otherwise we could have used <a href="https://github.com/d3/d3-array/blob/master/README.md#extent" class="sc-ifAKCX jnpqTa">d3.extent</a> to find the min and max values in the dataset and used those for the domains.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// initialize scales</span>
<span class="token keyword">const</span> xScale <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> plotAreaWidth<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yScale <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span>plotAreaHeight<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> colorScale <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">scaleLinear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">domain</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#x27;#06a&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;#0bb&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">We now have all the constants and scales we need to begin generating the SVG for our chart. We do the standard procedure of creating an <code class="language-text">&lt;svg&gt;</code> element with a <code class="language-text">&lt;g&gt;</code> tag translated inside it to reflect our desired padding.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// select the root container where the chart will be added</span>
<span class="token keyword">const</span> container <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#x27;#vis-container&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// initialize main SVG</span>
<span class="token keyword">const</span> svg <span class="token operator">=</span> container<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;svg&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;width&#x27;</span><span class="token punctuation">,</span> width<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;height&#x27;</span><span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// the main g where all the chart content goes inside</span>
<span class="token keyword">const</span> g <span class="token operator">=</span> svg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;transform&#x27;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>padding<span class="token punctuation">.</span>top<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">The base of the chart is now setup. Next we add the axes.</div>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Adding in Axes</h2>
<div class="sc-htpNat jeewNL">Adding in axes to charts is fairly simple with D3, since it comes with built-in helpers via <a href="https://github.com/d3/d3-axis" class="sc-ifAKCX jnpqTa">d3-axis</a> for generating them with reasonable defaults. Here we create the <code class="language-text">&lt;g&gt;</code> tags to use with d3-axis as well as <code class="language-text">&lt;text&gt;</code> tags to use as axis titles.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// add in axis groups</span>
<span class="token keyword">const</span> xAxisG <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">&#x27;x-axis&#x27;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;transform&#x27;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`translate(0 </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>plotAreaHeight <span class="token operator">+</span> pointRadius<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// x-axis label</span>
g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;text&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;transform&#x27;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>plotAreaWidth <span class="token operator">/</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>plotAreaHeight <span class="token operator">+</span> <span class="token punctuation">(</span>padding<span class="token punctuation">.</span>bottom<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;dy&#x27;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// adjust distance from the bottom edge</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;axis-label&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;text-anchor&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;middle&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#x27;X Axis&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> yAxisG <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">&#x27;y-axis&#x27;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;transform&#x27;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">-</span>pointRadius<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> 0)`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// y-axis label</span>
g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;text&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;transform&#x27;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`rotate(270) translate(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">-</span>plotAreaHeight <span class="token operator">/</span> <span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token operator">-</span>padding<span class="token punctuation">.</span>left<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;dy&#x27;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token comment">// adjust distance from the left edge</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;axis-label&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;text-anchor&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;middle&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&#x27;Y Axis&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// set up axis generating functions</span>
<span class="token keyword">const</span> xTicks <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>plotAreaWidth <span class="token operator">/</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yTicks <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>plotAreaHeight <span class="token operator">/</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> xAxis <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">axisBottom</span><span class="token punctuation">(</span>xScale<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">ticks</span><span class="token punctuation">(</span>xTicks<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tickSizeOuter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> yAxis <span class="token operator">=</span> d3
  <span class="token punctuation">.</span><span class="token function">axisLeft</span><span class="token punctuation">(</span>yScale<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">ticks</span><span class="token punctuation">(</span>yTicks<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tickSizeOuter</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// draw the axes</span>
yAxisG<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>yAxis<span class="token punctuation">)</span><span class="token punctuation">;</span>
xAxisG<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xAxis<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">A couple things of note:</div>
<ul class="core__List-eqpeba-0 dFzgml">
<li class="sc-bdVaJa efFTfJ">By default, d3-axis will add squared ends to the axes. Unless these ends happen to overlap one of the ticks, there will be strange spacing between them and the actual ticks of the axis, so I always call <code class="language-text">.tickSizeOuter(0)</code> to remove them.</li>
<li class="sc-bdVaJa efFTfJ">The number of ticks in the axes, <code class="language-text">xTicks</code> and <code class="language-text">yTicks</code>, are based on the dimensions of the chart. By doing this instead of using a constant value, we ensure that our ticks do not get too compressed or too sparse as the dimensions of the chart change.</li>
</ul>
<div class="sc-htpNat jeewNL">Next, we draw the points as circles.</div>
<h2 font-size="3" font-weight="bold" font-family="header" class="sc-bxivhb ecGEQi">Drawing the Points</h2>
<div class="sc-htpNat jeewNL">In this example, I&#x27;m only showing the enter step of <a href="https://bl.ocks.org/mbostock/3808234" class="sc-ifAKCX jnpqTa">D3&#x27;s update pattern</a>, so we just bind the data to a collection of circles and render them using our scales.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// add in circles</span>
<span class="token keyword">const</span> circles <span class="token operator">=</span> g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;g&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;circles&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> binding <span class="token operator">=</span> circles<span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span><span class="token string">&#x27;.data-point&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> d <span class="token operator">=&gt;</span> d<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

binding<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;circle&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">classed</span><span class="token punctuation">(</span><span class="token string">&#x27;data-point&#x27;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;r&#x27;</span><span class="token punctuation">,</span> pointRadius<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;cx&#x27;</span><span class="token punctuation">,</span> d <span class="token operator">=&gt;</span> <span class="token function">xScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;cy&#x27;</span><span class="token punctuation">,</span> d <span class="token operator">=&gt;</span> <span class="token function">yScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;fill&#x27;</span><span class="token punctuation">,</span> d <span class="token operator">=&gt;</span> <span class="token function">colorScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">We now have a scatterplot! ðŸŽ‰</div>
<div class="sc-htpNat jeewNL"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;max-width:608px;margin-left:auto;margin-right:auto">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:68.09210526315789%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABa0lEQVQ4y21UAZLDIAjM/5967UyTJlGjIscSsCatM6myArsodiIiTikxRqiVW2s8jtHG2m1fjzbGhJ89Rk6SbJePbKPKTLdkv9ajnSrxBGPfd4bSIp9vFpnrjX3JmaOQOgbCdLMnJFrXdWA5HWKpF4Vgz0aqCXgoud1KzsJM5phNZbLys+FhIADmOLdr2RMuZFmWDnRHcyoWXMmOwlTCPurp6zP8p+fzqQobSj8K5/oJdpLDME+SSu2ksLMlBK4Kt23TYA8qgyIMsrNCgF9cyPWy50PPMErb3NuiH/6PPgSZqyQ6saOcRNo2MQSVXaw0bI7JfPa9kWRNReNcqSZEyVUURSljE4dK7fISzgStl6oJaCz1Q6wlH8dxUTGeXz98VYZb/vhBAGkPcq9KFaJtgpS9yYtJKYriVc8VyoHjJb2l+XUtGPaCYK/3xq/5LXZQX+CqsKKJcbM2l1K+5sfjj+d5HnzwR4KYopjj/0OQUvJfE8Z/AAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
    <img display="block" class="gatsby-resp-image-image sc-bZQynM bQkNVd" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px #fff" alt="Scatterplot" title="" src="/static/745b73485afee0564c2dcae284073d8e/90762/scatterplot.png" srcSet="/static/745b73485afee0564c2dcae284073d8e/f57d2/scatterplot.png 175w, /static/745b73485afee0564c2dcae284073d8e/661bc/scatterplot.png 350w, /static/745b73485afee0564c2dcae284073d8e/90762/scatterplot.png 608w" sizes="(max-width: 608px) 100vw, 608px"/>
  </span></div>
<div class="sc-htpNat jeewNL">With that out of the way, let&#x27;s take a look at how we can use a Voronoi diagram to add interactivity to the chart.</div>
<div class="sc-htpNat jeewNL"><a name="voronoi" class="sc-ifAKCX jnpqTa"></a></div>
<h2 font-size="4" font-weight="bold" font-family="header" class="sc-bxivhb dJCJrh">Adding Interactivity with a Voronoi Diagram</h2>
<div class="sc-htpNat jeewNL">The first thing we need to do is make use of <a href="https://github.com/d3/d3-voronoi" class="sc-ifAKCX jnpqTa">d3-voronoi</a> to compute the Voronoi diagram of the points.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// create a Voronoi diagram based on the data and the scales</span>
<span class="token keyword">const</span> voronoiDiagram <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">voronoi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">x</span><span class="token punctuation">(</span>d <span class="token operator">=&gt;</span> <span class="token function">xScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">y</span><span class="token punctuation">(</span>d <span class="token operator">=&gt;</span> <span class="token function">yScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">[</span>plotAreaWidth<span class="token punctuation">,</span> plotAreaHeight<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">That&#x27;s all it takes to compute the diagram! <em>And</em> the <code class="language-text">size()</code> call is optional since we aren&#x27;t going to use the <code class="language-text">polygons</code> feature of the diagram. Note that we call the configured function with <code class="language-text">(data)</code> at the end, which is what computes the diagram based on our generated data.</div>
<div class="sc-htpNat jeewNL">Now that we have a computed Voronoi diagram, let&#x27;s add in some some mouse listeners to make use of it. We&#x27;ll draw an invisible rectangle over the plot area of the chart that will listen for mouse events and use the Voronoi diagram to highlight the nearest point to the mouse.</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// limit how far away the mouse can be from finding a Voronoi site</span>
<span class="token keyword">const</span> voronoiRadius <span class="token operator">=</span> plotAreaWidth <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">// add a circle for indicating the highlighted point</span>
g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;circle&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;highlight-circle&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;r&#x27;</span><span class="token punctuation">,</span> pointRadius <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// slightly larger than our points</span>
  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;fill&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;none&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;display&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;none&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// callback to highlight a point</span>
<span class="token keyword">function</span> <span class="token function">highlight</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// no point to highlight - hide the circle</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>d<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#x27;.highlight-circle&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;display&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;none&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// otherwise, show the highlight circle at the correct position</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    d3<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&#x27;.highlight-circle&#x27;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;display&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;&#x27;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;stroke&#x27;</span><span class="token punctuation">,</span> <span class="token function">colorScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;cx&#x27;</span><span class="token punctuation">,</span> <span class="token function">xScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;cy&#x27;</span><span class="token punctuation">,</span> <span class="token function">yScale</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// callback for when the mouse moves across the overlay</span>
<span class="token keyword">function</span> <span class="token function">mouseMoveHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// get the current mouse position</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>mx<span class="token punctuation">,</span> my<span class="token punctuation">]</span> <span class="token operator">=</span> d3<span class="token punctuation">.</span><span class="token function">mouse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// use the new diagram.find() function to find the Voronoi site</span>
  <span class="token comment">// closest to the mouse, limited by max distance voronoiRadius</span>
  <span class="token keyword">const</span> site <span class="token operator">=</span> voronoiDiagram<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> my<span class="token punctuation">,</span> voronoiRadius<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// highlight the point if we found one</span>
  <span class="token function">highlight</span><span class="token punctuation">(</span>site <span class="token operator">&amp;&amp;</span> site<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// add the overlay on top of everything to take the mouse events</span>
g<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&#x27;rect&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;class&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;overlay&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;width&#x27;</span><span class="token punctuation">,</span> plotAreaWidth<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">&#x27;height&#x27;</span><span class="token punctuation">,</span> plotAreaHeight<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;fill&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;#f00&#x27;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">style</span><span class="token punctuation">(</span><span class="token string">&#x27;opacity&#x27;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#x27;mousemove&#x27;</span><span class="token punctuation">,</span> mouseMoveHandler<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#x27;mouseleave&#x27;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// hide the highlight circle when the mouse leaves the chart</span>
    <span class="token function">highlight</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">The important part is how we used <code class="language-text">voronoiDiagram.find()</code> to find the nearest Voronoi site to the mouse:</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> site <span class="token operator">=</span> voronoiDiagram<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>mx<span class="token punctuation">,</span> my<span class="token punctuation">,</span> voronoiRadius<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">The <code class="language-text">site</code> object returned from this function contains a key <code class="language-text">data</code> that returns one of the data points from our original <code class="language-text">data</code> array. We then use that data point to update the position of our highlight circle, indicating to the users which point is highlighted. Since we used a Voronoi diagram, it will be the point nearest the mouse.</div>
<div class="sc-htpNat jeewNL">This method gives us access to the highlighted data point-- we can do whatever we like with it! In the <a href="./demo/" class="sc-ifAKCX jnpqTa">demo</a>, I show how we can display the contents of the highlighted point in a <code class="language-text">&lt;div&gt;</code> beneath the chart.</div>
<div class="sc-htpNat jeewNL"><img display="block" src="/scatterplot-voronoi-c73d58d6d6148ef69f87705ef63305f3.gif" alt="Demo GIF" class="sc-bZQynM bQkNVd"/></div>
<div class="sc-htpNat jeewNL">Note that I arbitrarily set the <code class="language-text">voronoiRadius</code> to 1/10th the width of the plot area:</div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> voronoiRadius <span class="token operator">=</span> plotAreaWidth <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span></code></pre></div>
<div class="sc-htpNat jeewNL">This makes it so the point is only highlighted if you&#x27;re relatively close to it, even if you are in the corresponding voronoi cell. Feel free to play with this value to get something that works for you!</div>
<h2 font-size="4" font-weight="bold" font-family="header" class="sc-bxivhb dJCJrh">Conclusion</h2>
<div class="sc-htpNat jeewNL">That&#x27;s it! We&#x27;ve got a basic scatterplot with hover behavior driven by a Voronoi diagram. My next post will show how we can add a brush to our scatterplot to select points efficiently with a quadtree, all while retaining the hover behavior shown in this post.</div>
<div class="sc-htpNat jeewNL">If you have any questions or comments, please leave a comment below or send me a tweet <a href="https://twitter.com/pbesh" class="sc-ifAKCX jnpqTa">@pbesh</a>. In case you missed it, there&#x27;s a <a href="./demo/" class="sc-ifAKCX jnpqTa">live demo</a> of this code on my site and the full source code is available on <a href="https://github.com/pbeshai/pbeshai.github.io/tree/master/src/blog/2016-10-30-scatterplot-in-d3-with-voronoi-interaction/demo" class="sc-ifAKCX jnpqTa">GitHub</a>.</div></div><div class="sc-bdVaJa hhyHDk"><div id="disqus_thread"></div></div></div><div class="sc-bdVaJa gTlRLk"><div class="sc-htpNat jsxnmT"><ul class="core__InlineList-eqpeba-1 ijWubC"><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="mailto:peter.beshai@gmail.com" class="sc-ifAKCX jnpqTa">peter.beshai@gmail.com</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="https://twitter.com/pbesh" class="sc-ifAKCX jnpqTa">Twitter</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="https://www.linkedin.com/in/pbeshai" class="sc-ifAKCX jnpqTa">LinkedIn</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="https://github.com/pbeshai" class="sc-ifAKCX jnpqTa">GitHub</a></li><li class="core__InlineListItem-eqpeba-2 cnqcGN"><a href="https://instagram.com/pbeshasketch" class="sc-ifAKCX jnpqTa">Instagram</a></li></ul></div></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-55938435-1', 'auto', {});
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"blog-2016-10-30-scatterplot-in-d-3-with-voronoi-interaction-5d6","path":"/blog/2016-10-30-scatterplot-in-d3-with-voronoi-interaction/"};window.dataPath="386/path---blog-2016-10-30-scatterplot-in-d-3-with-voronoi-interaction-5-d-6-449-FxQil3GmuCCdFSPzFvIhw3B2Hk0";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-b6ef64a05ca2a06bac27.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.1d3c152f5f561507ccdb.css","/component---src-templates-blog-post-js-e86b92af2fef775e9216.js"],"component---src-templates-demo-js":["/component---src-templates-demo-js.1d3c152f5f561507ccdb.css","/component---src-templates-demo-js-b27d21192def89634b14.js"],"component---src-pages-404-js":["/component---src-pages-404-js.1d3c152f5f561507ccdb.css","/component---src-pages-404-js-2dcf30a3796301dfd370.js"],"component---src-pages-index-js":["/component---src-pages-index-js.1d3c152f5f561507ccdb.css","/component---src-pages-index-js-f13e40757851358cd162.js"]};/*]]>*/</script><script src="/webpack-runtime-594d0c96fca390bc02fb.js" async=""></script><script src="/0-d7ef72559a49db3dc3fb.js" async=""></script><script src="/1-be46941191aa236417e9.js" async=""></script><script src="/app-b6ef64a05ca2a06bac27.js" async=""></script><script src="/component---src-templates-blog-post-js-e86b92af2fef775e9216.js" async=""></script></body></html>